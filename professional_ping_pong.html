<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Professional Ping Pong</title>
  <style>
    body {
      margin: 0;
      background: #0d0d0d;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    canvas {
      display: block;
      margin: 20px auto;
      background: radial-gradient(circle at center, #111, #000);
      border: 2px solid #fff;
      border-radius: 8px;
      box-shadow: 0 0 20px rgba(255,255,255,0.2);
    }
    button {
      margin: 6px;
      padding: 10px 16px;
      font-size: 16px;
      cursor: pointer;
      border-radius: 6px;
      border: none;
      background: #222;
      color: white;
      transition: background 0.3s;
    }
    button:hover { background: #444; }
    #score {
      font-size: 18px;
      margin: 10px;
    }
    #gameOverModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #222;
      border: 2px solid #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 30px rgba(255,255,255,0.4);
      z-index: 10;
    }
    #mobileControls {
      display: none;
      margin-top: 15px;
    }
    #mobileControls button {
      width: 60px;
      height: 60px;
      font-size: 24px;
      border-radius: 50%;
    }
    @media (max-width: 600px) {
      #mobileControls { display: block; }
    }
  </style>
</head>
<body>
  <h1>üèì Professional Ping Pong</h1>
  <canvas id="gameCanvas" width="400" height="600"></canvas>
  <p id="score">Player: 0 | Computer: 0 | Level: 1</p>
  <button id="playPauseBtn">Play</button>
  <button onclick="resetGame()">Restart</button>
  <button onclick="toggleSound()">üîä Sound</button>
  <select id="levelSelect" onchange="setLevel(this.value)">
    <option value="1">Level 1</option>
    <option value="2">Level 2</option>
    <option value="3">Level 3</option>
  </select>
  <div id="mobileControls">
    <button onclick="moveLeft()">‚¨ÖÔ∏è</button>
    <button onclick="moveRight()">‚û°Ô∏è</button>
  </div>

  <div id="gameOverModal">
    <h2 id="result"></h2>
    <button onclick="resetGame()">Play Again</button>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const playPauseBtn = document.getElementById("playPauseBtn");
    const resultText = document.getElementById("result");
    const scoreText = document.getElementById("score");
    const gameOverModal = document.getElementById("gameOverModal");
    const levelSelect = document.getElementById("levelSelect");

    let paddleWidth = 80, paddleHeight = 10;
    let playerX = canvas.width/2 - paddleWidth/2;
    const playerY = canvas.height - 30;
    let playerPrevX = playerX;

    let computerX = canvas.width/2 - paddleWidth/2;
    const computerY = 20;
    let computerPrevX = computerX;

    let ballX = canvas.width/2, ballY = canvas.height/2;
    let ballSpeedX = 3, ballSpeedY = 3;
    const ballRadius = 8;
    let trail = [];

    let rightPressed=false, leftPressed=false;
    let playerScore=0, computerScore=0, level=1;
    const winScore = 10;
    let playing=false, gameOver=false;

    let soundOn = true;
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    const audioCtx = new AudioCtx();

    const speeds = {
      1:{ball:3, ai:2, paddle:80},
      2:{ball:4, ai:3, paddle:70},
      3:{ball:5, ai:4, paddle:60}
    };

    // Controls
    document.addEventListener("keydown", e=>{
      if(e.key==="ArrowRight") rightPressed=true;
      if(e.key==="ArrowLeft") leftPressed=true;
    });
    document.addEventListener("keyup", e=>{
      if(e.key==="ArrowRight") rightPressed=false;
      if(e.key==="ArrowLeft") leftPressed=false;
    });

    // Mobile controls
    function moveLeft(){playerX -= 20;}
    function moveRight(){playerX += 20;}

    function playSound(freq=440,dur=0.1){
      if(!soundOn) return;
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      osc.type = "sine";
      osc.frequency.value = freq;
      osc.start();
      gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
      osc.stop(audioCtx.currentTime+dur);
    }

    function toggleSound(){soundOn=!soundOn;}

    // Buttons
    playPauseBtn.addEventListener("click", ()=>{
      if(gameOver){ resetGame(); return; }
      playing=!playing;
      playPauseBtn.innerText = playing?"Pause":"Play";
    });

    function setLevel(lv){
      level=parseInt(lv);
      paddleWidth = speeds[level].paddle;
      resetBall();
    }

    // Reset functions
    function resetBall(){
      ballX=canvas.width/2;
      ballY=canvas.height/2;
      let speed = speeds[level].ball;
      ballSpeedX = (Math.random()>0.5?1:-1)*speed;
      ballSpeedY = (Math.random()>0.5?1:-1)*speed;
      trail = [];
    }

    function resetGame(){
      playerScore=0; computerScore=0; gameOver=false;
      gameOverModal.style.display="none";
      resultText.innerText="";
      playPauseBtn.innerText="Play";
      setLevel(level);
    }

    // Drawing
    function drawPaddle(x,y){ctx.fillStyle="white"; ctx.fillRect(x,y,paddleWidth,paddleHeight);}
    function drawBall(){
      trail.push({x:ballX,y:ballY});
      if(trail.length>10) trail.shift();
      for(let i=0;i<trail.length;i++){
        let t=trail[i];
        ctx.beginPath();
        ctx.arc(t.x,t.y,ballRadius*(i/trail.length),0,Math.PI*2);
        ctx.fillStyle=`rgba(255,0,0,${i/trail.length})`;
        ctx.fill();
      }
      ctx.beginPath();
      ctx.arc(ballX,ballY,ballRadius,0,Math.PI*2);
      ctx.fillStyle="red";
      ctx.shadowBlur=10; ctx.shadowColor="red";
      ctx.fill();
      ctx.shadowBlur=0;
      ctx.closePath();
    }

    // Update
    function update(){
      if(!playing || gameOver) return;

      // Player movement
      if(rightPressed) playerX += 6;
      if(leftPressed) playerX -= 6;
      if(playerX<0) playerX=0;
      if(playerX+paddleWidth>canvas.width) playerX=canvas.width-paddleWidth;
      let playerVel = playerX - playerPrevX;

      // Computer AI
      let compCenter = computerX + paddleWidth/2;
      const aiSpeed = speeds[level].ai;
      if(Math.abs(ballX - compCenter) > 10){
        if(compCenter<ballX) computerX+=aiSpeed;
        else computerX-=aiSpeed;
      }
      if(computerX<0) computerX=0;
      if(computerX+paddleWidth>canvas.width) computerX=canvas.width-paddleWidth;
      let computerVel = computerX - computerPrevX;

      // Collisions
      if(ballSpeedY>0 && ballY+ballRadius >= playerY && ballY-ballRadius <= playerY+paddleHeight){
        if(ballX + ballRadius >= playerX && ballX - ballRadius <= playerX+paddleWidth){
          ballSpeedY = -Math.abs(ballSpeedY);
          ballSpeedX += playerVel*0.3;
          ballY = playerY - ballRadius;
          playSound(600);
        }
      }
      if(ballSpeedY<0 && ballY-ballRadius <= computerY+paddleHeight && ballY+ballRadius >= computerY){
        if(ballX + ballRadius >= computerX && ballX - ballRadius <= computerX+paddleWidth){
          ballSpeedY = Math.abs(ballSpeedY);
          ballSpeedX += computerVel*0.3;
          ballY = computerY + paddleHeight + ballRadius;
          playSound(400);
        }
      }

      // Update ball
      ballX += ballSpeedX;
      ballY += ballSpeedY;

      // Walls
      if(ballX-ballRadius<0 || ballX+ballRadius>canvas.width){
        ballSpeedX=-ballSpeedX; playSound(200);
      }

      // Score
      if(ballY>canvas.height){
        computerScore++; resetBall(); playSound(150);
      }
      if(ballY<0){
        playerScore++; resetBall(); playSound(800);
      }

      // Win check
      if(playerScore>=winScore){
        resultText.innerText="üéâ You Win!";
        gameOver=true; playing=false; playPauseBtn.innerText="Restart";
        gameOverModal.style.display="block"; playSound(1000,0.3);
      }
      if(computerScore>=winScore){
        resultText.innerText="üò¢ You Lose!";
        gameOver=true; playing=false; playPauseBtn.innerText="Restart";
        gameOverModal.style.display="block"; playSound(100,0.3);
      }

      playerPrevX = playerX;
      computerPrevX = computerX;
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      drawPaddle(playerX,playerY);
      drawPaddle(computerX,computerY);
      drawBall();
      scoreText.innerText = `Player: ${playerScore} | Computer: ${computerScore} | Level: ${level}`;
    }

    function gameLoop(){update(); draw(); requestAnimationFrame(gameLoop);}
    setLevel(1); gameLoop();
  </script>
</body>
</html>
